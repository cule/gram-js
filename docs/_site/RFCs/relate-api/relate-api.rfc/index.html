<!DOCTYPE html>

<html lang="en">
<head>
  <title></title>
  <meta name="description" content="The reference implementation of Gram.">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>gram.js | The reference implementation of Gram.</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="gram.js" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The reference implementation of Gram." />
<meta property="og:description" content="The reference implementation of Gram." />
<link rel="canonical" href="http://localhost:4000/RFCs/relate-api/relate-api.rfc/" />
<meta property="og:url" content="http://localhost:4000/RFCs/relate-api/relate-api.rfc/" />
<meta property="og:site_name" content="gram.js" />
<script type="application/ld+json">
{"headline":"gram.js","description":"The reference implementation of Gram.","url":"http://localhost:4000/RFCs/relate-api/relate-api.rfc/","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/site.css">
  <!-- <link rel="stylesheet" href="/assets/site.css"> --><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="gram.js" /><link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href=" "">
  <link rel="icon" type="image/png" sizes="16x16" href=""">
  <link rel="manifest" href="/assets/favicon/site.webmanifest">
  <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/assets/favicon/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

</head>
<body class="bg-gray-100 tracking-wider tracking-normal">
<nav id="header" class="fixed w-full z-10 top-0 bg-white border-b border-gray-400">

  <div class="w-full container mx-auto flex flex-wrap items-center justify-between mt-0 py-4">
     <div class="pl-4 flex items-center">
        <a class="text-gray-900 text-base no-underline hover:no-underline font-neo4j font-thin text-xl pb-2"  href="/"> 
         gram.js
         0.0
        </a>
     </div>
     
     <div>
      <div class="block lg:hidden pr-4">
            <button id="nav-toggle" class="flex items-center px-3 py-2 border rounded text-gray-500 border-gray-600 hover:text-gray-900 hover:border-purple-500 appearance-none focus:outline-none">
               <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <title>Menu</title>
                  <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/>
               </svg>
            </button>
         </div>
         <div class="w-full flex-grow lg:flex  lg:content-center lg:items-center lg:w-auto hidden lg:block mt-2 lg:mt-0 z-20" id="nav-content">
            
            <ul class="list-reset lg:flex justify-end items-center">
               <li class="mr-3 py-2 lg:py-0">
                  <a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:underline py-2 px-4" href="/guides/">Guides</a>
               </li>
               <li class="mr-3 py-2 lg:py-0">
                  <a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:underline py-2 px-4" href="/api/">API</a>
               </li>
            </ul>
         </div>
      </div>
  </div>
</nav>

<script>
   /*Toggle dropdown list*/
   /*https://gist.github.com/slavapas/593e8e50cf4cc16ac972afcbad4f70c8*/
   
   var navMenuDiv = document.getElementById("nav-content");
   var navMenu = document.getElementById("nav-toggle");
   
   var helpMenuDiv = document.getElementById("menu-content");
   var helpMenu = document.getElementById("menu-toggle");
   
   document.onclick = check;
   
   function check(e){
     var target = (e && e.target) || (event && event.srcElement);
   
    
     //Nav Menu
     if (!checkParent(target, navMenuDiv)) {
      // click NOT on the menu
      if (checkParent(target, navMenu)) {
        // click on the link
        if (navMenuDiv.classList.contains("hidden")) {
         navMenuDiv.classList.remove("hidden");
        } else {navMenuDiv.classList.add("hidden");}
      } else {
        // click both outside link and outside menu, hide menu
        navMenuDiv.classList.add("hidden");
      }
     }
     
     //Help Menu
     if (!checkParent(target, helpMenuDiv)) {
      // click NOT on the menu
      if (checkParent(target, helpMenu)) {
        // click on the link
        if (helpMenuDiv.classList.contains("hidden")) {
         helpMenuDiv.classList.remove("hidden");
        } else {helpMenuDiv.classList.add("hidden");}
      } else {
        // click both outside link and outside menu, hide menu
        helpMenuDiv.classList.add("hidden");
      }
     }
     
   }
   
   function checkParent(t, elm) {
     while(t.parentNode) {
      if( t == elm ) {return true;}
      t = t.parentNode;
     }
     return false;
   }
   
   
</script>
<main class="page-content" aria-label="Content">
      <div class="container w-full flex flex-wrap mx-auto px-2 pt-8 lg:pt-16 mt-16">
   <div class="w-full lg:w-1/5 lg:px-6 text-xl text-gray-800 leading-normal"><p class="text-base font-bold py-2 lg:pb-6 text-gray-700"><a href="/guides/">Guides</a></p>
<div class="block lg:hidden sticky inset-0">
   <button id="menu-toggle" class="flex w-full justify-end px-3 py-3 bg-white lg:bg-transparent border rounded border-gray-600 hover:border-blue-500 appearance-none focus:outline-none">
      <svg class="fill-current h-3 float-right" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
         <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/>
      </svg>
   </button>
</div>
<div class="w-full sticky inset-0 hidden h-64 lg:h-auto overflow-x-hidden overflow-y-auto lg:overflow-y-hidden lg:block mt-0 border border-gray-400 lg:border-transparent bg-white shadow lg:shadow-none lg:bg-transparent z-20" style="top:5em;" id="menu-content">
   <ul class="list-reset">
      
      <li class="py-2 md:my-0 hover:bg-blue-100 lg:hover:bg-transparent">
         <a href="/guides/gram-ast/" 
            
               class="block pl-4 align-middle text-gray-700 no-underline hover:text-blue-500 border-l-4 border-transparent lg:hover:border-gray-400"
            
         >
         <span class="pb-1 md:pb-0 text-sm text-gray-900 font-bold">Gram Ast</span>
         </a>
      </li>
      
      <li class="py-2 md:my-0 hover:bg-blue-100 lg:hover:bg-transparent">
         <a href="/guides/gram-builder/" 
            
               class="block pl-4 align-middle text-gray-700 no-underline hover:text-blue-500 border-l-4 border-transparent lg:hover:border-gray-400"
            
         >
         <span class="pb-1 md:pb-0 text-sm text-gray-900 font-bold">Gram Builder</span>
         </a>
      </li>
      
      <li class="py-2 md:my-0 hover:bg-blue-100 lg:hover:bg-transparent">
         <a href="/guides/gram-parse/" 
            
               class="block pl-4 align-middle text-gray-700 no-underline hover:text-blue-500 border-l-4 border-transparent lg:hover:border-gray-400"
            
         >
         <span class="pb-1 md:pb-0 text-sm text-gray-900 font-bold">Gram Parse</span>
         </a>
      </li>
      
   </ul>
</div>
</div>
   <div class="w-full lg:w-4/5 p-8 mt-6 lg:mt-0 text-gray-900 leading-normal bg-white border border-gray-400 border-rounded">
      <!--Title-->
      <div class="font-sans">
         <h1 class="font-sans break-normal text-gray-900 pt-6 pb-2 text-xl"></h1>
         <hr class="border-b border-gray-400">
      </div>
      <!--Page Content-->
      <div class="prose max-w-none">
         <ul>
  <li>Start Date: (2020-01-15)</li>
  <li>RFC PR: https://github.com/neo4j-devtools/relate/pull/1</li>
  <li>@relate Issue: (leave this empty)</li>
</ul>

<h1 id="summary">Summary</h1>

<p>In this RFC, we propose a unified API surface for interacting with the Neo4j platform.
In this context, “platform” is defined as the collection of Environments (Local, Aura), Services (IDaaS, User Data Storage, Graph Apps), and Tools (Apps, Drivers, Plugins).
The outcome of which is dubbed “Desktop 2.X”, and enables interaction through 4 entry-points:</p>

<ul>
  <li><em>As a WEB server</em>, allowing HTTP clients access to a typed GraphQL schema as well as static resources (apps)</li>
  <li><em>As a CLI</em>, allowing shell clients to setup advanced, automated, workflows and integrate with other processes</li>
  <li><em>As a Javascript library</em>, allowing applications to programmatically compose applications using Dependency Injection</li>
  <li><em>As an Electron application</em>, allowing native OS clients access to the above as well as OS specific features (Keychains etc.)</li>
</ul>

<p><img src="/RFCs/relate-api/imgs/architecture.png" alt="Architecture" /></p>

<p>Our primary focus is support for Neo4j 4.x and feature parity with the current <a href="https://github.com/neo4j-apps/relate-api">@neo4j/relate-api</a> schema.</p>

<p>For now we will use the project name <code class="language-plaintext highlighter-rouge">@relate</code> until we have found a real name for said API.</p>

<h1 id="basic-example">Basic example</h1>

<h2 id="graphql">GraphQL</h2>

<pre><code class="language-GraphQL">query GetDbNames {
    environment(nameOrId: "local") {
        dbmss {
            id,
            dbs {
                name
            }
        }
    }
}
</code></pre>

<h2 id="cli">CLI</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>relate environment:use <span class="s2">"local"</span> <span class="c"># set current Environment to "local"</span>
<span class="nv">$ </span>relate dbms:use <span class="s2">"neo4j"</span> <span class="c"># set current DBMS to "neo4j"</span>
<span class="nv">$ </span>relate db:list | <span class="nb">awk</span> <span class="s1">'{print $2}'</span> <span class="c"># list db names (eg. col 2)</span>
</code></pre></div></div>

<h2 id="javascripttypescript">JavaScript/TypeScript</h2>

<pre><code class="language-TypeScript">import Relate, {Database} from '@relate/core';

const dbs: Promise&lt;Database[]&gt; = Relate.useEnvironment('local')
    .then((environment) =&gt; environment.useDBMS('neo4j'))
    .then((dbms) =&gt; dbms.listDBs())
</code></pre>

<h1 id="motivation">Motivation</h1>

<p>As we are adding more and more ways for consumers (web developers, application developers, system developers) to interact with our core product (local, on-premise, cloud),
as well as increasing the feature set of our products (clustering, multi-db, transactions),
we need to ensure that they have access to a homogeneous, extensible, and intuitive API that empowers them to do great work.</p>

<p>The expected outcome of this project is a JavaScript library/toolkit that allows you to do everything Neo4j Desktop does without the need to install electron.
Said library should provide extension points to attach custom logic and be usable in code, in the CLI, and over the wire (HTTP).</p>

<p>The user experience should be as similar as possible across environments and allow consumers to build up a “Neo4j muscle memory”.
In addition, we will leverage the power of established frameworks and patterns in the JavaScript community to reduce the Neo4j specific “learning curve” and maintenance cost.</p>

<h1 id="detailed-design">Detailed design</h1>

<h2 id="end-user-deliverables-in-order-of-priority">End-user Deliverables (in order of priority)</h2>

<ol>
  <li>An improved Neo4j Desktop 2.0
    <ul>
      <li>Feature parity with Neo4j Desktop 1.x</li>
      <li>Easier to maintain by decomposing into a core library, web server, and web UI packaged into an electron app</li>
      <li>Neo4j 4.0 optimized with separate lifecycles for the DBMS and multiple databases</li>
      <li>Feature complete GraphQL API that expresses all interactions possible through the current user interface</li>
      <li>File-system-like behaviors (open with… for dbs and well-known files like cypher, guides, csv, gram)</li>
      <li>Project definition to enable examples, bootstrapping, collaboration</li>
    </ul>
  </li>
  <li>User workflows to/from Aura &amp; sandbox
    <ul>
      <li>Requires a “Neo4j Environment” and probably token-based auth</li>
    </ul>
  </li>
  <li>A web-server with the same capabilities as Desktop
    <ul>
      <li>A common request for Bloom and even Browser</li>
      <li>Should participate in web-auth flows</li>
      <li>Minus any OS-integrations</li>
      <li>Minus “hosting” remote applications</li>
    </ul>
  </li>
  <li>CLI tool for awesome developer flows
    <ul>
      <li>As smooth as <code class="language-plaintext highlighter-rouge">gcloud</code> or <code class="language-plaintext highlighter-rouge">heroku</code> or <code class="language-plaintext highlighter-rouge">gh</code></li>
    </ul>
  </li>
</ol>

<p>These deliverables are enabled through an underlying JavaScript library (the “toolkit”) that allows for programmatically interacting with the Neo4j platform.
The basis of the toolkit is a collection of modules, providers, microservices, et al. that can readily be composed into an application using a Dependency Injection framework.
This enables us to ship modular, extensible, and scalable code that is easy for consumers to discover and adopt. Further it allows us to deliver, support, and extend above mentioned deliverables in a controlled and efficient manner.</p>

<p>Some specific details we’d like to highlight:</p>

<ul>
  <li>Inside <code class="language-plaintext highlighter-rouge">@relate</code> all entity (Environment, App, Project, DBMS, DB, Graph) instances have a unique ID, as well as a unique name (by namespace), this to facilitate both user and programmatic access.</li>
  <li>The API should be semantically the same regardless of if you are using the Programmatic, HTTP, or CLI APIs</li>
  <li>The concept of Environments make it easy to protect sensitive information such credentials, and provide a clear chain of trust.</li>
  <li>Dependency Injection and typed language reduce the possibility of a host of bugs and exceptions, as well as providing an established pragma for extending applications.</li>
</ul>

<h2 id="a-note-on-nomenclature">A Note on Nomenclature</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Environment</code> here refers to a top level trusted authority containing certificates, keys, credentials, et. al. A container of all things, and the root of our chain of trust:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">App</code> here refers to a web application that allows you to interact with Neo4j using a GUI, whose access is managed by it’s <code class="language-plaintext highlighter-rouge">Environment</code>.</li>
      <li><code class="language-plaintext highlighter-rouge">Project</code> here refers to where users organize their <code class="language-plaintext highlighter-rouge">DB</code>’s (and with other relevant content), whose access is managed by it’s <code class="language-plaintext highlighter-rouge">Environment</code>.</li>
      <li><code class="language-plaintext highlighter-rouge">DBMS</code> here refers to a Neo4j DBMS instance, whose access is managed by it’s <code class="language-plaintext highlighter-rouge">Environment</code>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">DB</code> here refers to a Neo4j Database instance, whose access is managed by it’s <code class="language-plaintext highlighter-rouge">DBMS</code>
            <ul>
              <li><code class="language-plaintext highlighter-rouge">Graph</code> here refers to Neo4j Graph instance, whose access is managed by it’s <code class="language-plaintext highlighter-rouge">DB</code></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Services</code> here refers to local and remote resources that we choose to officially integrate with</li>
  <li><code class="language-plaintext highlighter-rouge">Tools</code> here refers to other known programmatic/CLI/HTTP utilities that we choose to officially integrate with</li>
</ul>

<h2 id="engineering-goals">Engineering Goals</h2>

<ul>
  <li>The toolkit should enable users to safely create and store Environment configurations, use a given Environment to create, interact, and remove DBMS instances, and for each DBMS create, interact, and drop Databases.</li>
  <li>The toolkit should be environment agnostic, aka function just as well on the CLI, over the wire (HTTP), and in native environments (OS/Electron). Should certain features not be available, this should be clear but not have an impact on functionality/stability</li>
  <li>The toolkit should be easy to extend using the established dependency injection patterns of <a href="https://nestjs.com/">NestJS</a>. Main advantage being the ability to swap out components as features come and go.</li>
  <li>The toolkit should leverage existing technology and documentation so that consumers are able to use preexisting knowledge and ramp up quickly. This includes (but is not limited to): DI using <code class="language-plaintext highlighter-rouge">@nestjs</code>, CLI using <code class="language-plaintext highlighter-rouge">@oclif</code>, and HTTP using <code class="language-plaintext highlighter-rouge">GraphQL</code>.</li>
</ul>

<h1 id="drawbacks">Drawbacks</h1>

<ul>
  <li>There are some learning curves involved in the above which will have an impact on the teams pace of delivery initially</li>
  <li>Dependency Injection is opinionated and not to everyones liking, there is a possibility for push back</li>
  <li>Maintaining support for 4 different environments and in addition keeping them homogeneous requires solid communication. Information silos are the enemy here</li>
</ul>

<h1 id="alternatives">Alternatives</h1>

<h3 id="continuing-with-desktop-1x">Continuing with Desktop 1.x</h3>

<p>Desktop 1.X is an aging codebase that has seen a lot of development and changes as Neo4j has grown. Attempting to modify it to suit a “cloud-first” future is deemed hard due to the tech debt and size of the codebase.</p>

<h3 id="ingesting-community-projects">Ingesting community projects</h3>

<p>We could scour the community for tools and projects that address these areas. The risk here is trying to shoehorn implementations to fit our needs, as well as the possibility of hidden issues and tech debt.</p>

<h1 id="adoption-strategy">Adoption strategy</h1>

<blockquote>
  <p>Our business goal is to increase the adoption of Neo4j, and improve developer productivity</p>
</blockquote>

<ul>
  <li>Work closely with Dev-Rel to raise awareness in the community</li>
  <li>Work closely with Aura to encourage adoption and migration</li>
  <li>A CLI to integrate with developers existing tooling and workflows</li>
  <li>Solid API docs (following established structures such as <code class="language-plaintext highlighter-rouge">man</code> pages and JSDoc)</li>
  <li>GraphQL schema</li>
  <li>Explicit and relevant error messages with helpful suggestions</li>
  <li>Creation of code “recipes” or template projects to reduce boilerplating</li>
</ul>

      </div>
      <!--/ Page Content-->
   </div>

   <!-- page footer -->
   <div class="w-full container mx-auto items-center justify-between mt-0 py-4">
      <div class="float-right lg:content-center lg:items-center lg:w-auto hidden lg:block mt-2 lg:mt-0 z-20" id="nav-content">
         <a href="https://github.com/gram-data/gram-js/tree/master/docs/relate-api.rfc.md">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current inline-block text-gray-500 h-5 w-5">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
            <span>Help improve this page</span>
            </a>
      </div>
   </div>
</div>

    </main><footer class="bg-white border-t border-gray-400 shadow">
  <div class="container mx-auto flex flex-wrap items-center justify-between p-8">
     <div class="w-3/4 mx-auto flex flex-grow flex-wrap">
        <div class="flex w-full lg:w-1/2 ">
           <div>
              <h3 class="font-bold text-gray-900">About gram.js</h3>
              <p class="py-4 text-gray-600 text-sm">
                 The reference implementation of Gram. 
              </p>
           </div>
        </div>
     </div>
     <div class=""><div class="grid grid-flow-col grid-cols-3 gap-2"><div ><a rel="me" href="https://github.com/gram-data" title="gram-data"><svg role="img" width="2em" height="2em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a></div><div><a rel="me" href="https://stackoverflow.com/questions/tagged/gram-data" title="gram-data"><svg role="img" width="2em" height="2em"viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Stack Overflow icon</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"/></svg></a></div><div><a rel="me" href="https://twitter.com/akollegger" title="akollegger"><svg role="img" width="2em" height="2em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter icon</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg></a></div></div></div>
  </div>
</footer>
</body>

</html>